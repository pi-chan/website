
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>xoyipメモ置き場</title>
	<meta name="author" content="xoyip">

	
	<meta name="description" content="2014/05/22 ActiveSupport, Rails activesupport-4.1.1/lib/active_support.rb 各種モジュールをActiveSupport::Autoload#autoloadメソッドで読み込む仕事が全て。 ActiveSupport:: &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="xoyipメモ置き場" type="application/atom+xml">
	
	<link rel="canonical" href="http://site.piyox.info/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<img src="http://www.gravatar.com/avatar/8f2d6bbbafa2bd93581f59b219138669?s=160" alt="Profile Picture" style="width: 160px;" />
	
</div>

<nav id="main-nav"><ul class="main">
    <li><a href="/">Home</a></li>
    <li><a href="/blog/archives">Archives</a></li>
    <li><a href="http://xoyip.hatenablog.com/">Hatena Blog</a></li>
    <li><a href="http://xoyip.hatenablog.com/entry/2014/01/01/204123">About</a></li>
</ul>

<section class="aboutme">
  <p>
    学んだことをメモっておくところ
  </p>
</section>
</nav>
<nav id="sub-nav">
	<div class="social">
		
			<a class="email" href="mailto:xoyip@piyox.info" title="Email">Email</a>
		
		
		
		
			<a class="twitter" href="http://twitter.com/xoyip" title="Twitter">Twitter</a>
		
		
			<a class="github" href="https://github.com/xoyip" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-22T13:34:07+09:00" data-updated="true" itemprop="datePublished">2014/05/22</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/activesupport/'>ActiveSupport</a>, <a class='category' href='/blog/categories/rails/'>Rails</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/22/active-support-dot-rb/" itemprop="url">activesupport-4.1.1/lib/active_support.rb</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>各種モジュールを<code>ActiveSupport::Autoload#autoload</code>メソッドで読み込む仕事が全て。</p>

<h1>ActiveSupport::Autoload#autoload</h1>

<p>単なる<code>autoload</code>は、実質的にrubyの<code>autoload</code>に相当しており、<code>eager_autoload</code>ブロック内の<code>autoload</code>は実質的には<code>require</code>になる。</p>

<p>ActiveSupportのautoloadはRuby組み込みのautoloadと異なる2つの特徴を持つ。</p>

<ul>
<li>規約により第二引数のパスを省略できる</li>
<li>eager_autoloadブロック内ではrequire相当の動きをする</li>
</ul>


<h2>Rubyにおけるrequireとautoloadの違い</h2>

<p><code>require</code>は即座にロード、<code>autoload</code>は必要になったときにロード。</p>

<h1>サンプルコード</h1>

<p>どんな動きになるかを実際に試してみる。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># main.rb</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;rubygems&quot;</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;bundler/setup&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;pry&quot;</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;active_support/dependencies/autoload&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="vg">$:</span><span class="o">.</span><span class="n">unshift</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">Xoyip</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="ss">ActiveSupport</span><span class="p">:</span><span class="ss">:Autoload</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">autoload</span> <span class="ss">:Hoge</span>
</span><span class='line'>  <span class="n">eager_autoload</span> <span class="k">do</span>
</span><span class='line'>    <span class="nb">autoload</span> <span class="ss">:Fuga</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Xoyip</span><span class="o">.</span><span class="n">eager_load!</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;after calling &#39;Xoyip.eager_load!&#39;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">h</span> <span class="o">=</span> <span class="ss">Xoyip</span><span class="p">:</span><span class="ss">:Hoge</span><span class="o">.</span><span class="n">new</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># xoyip/hoge.rb</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;loading Hoge&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">Xoyip</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">Hoge</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">hoge</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;hoge&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># xoyip/fuga.rb</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;loading Fuga&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">Xoyip</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">Fuga</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">fuga</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;fuga&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>実行結果</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sx">% ruby </span><span class="n">main</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'><span class="n">loading</span> <span class="no">Fuga</span>
</span><span class='line'><span class="n">after</span> <span class="n">calling</span> <span class="s1">&#39;Xoyip.eager_load!&#39;</span>
</span><span class='line'><span class="n">loading</span> <span class="no">Hoge</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-30T11:18:10+09:00" data-updated="true" itemprop="datePublished">2014/04/30</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/error/'>Error</a>, <a class='category' href='/blog/categories/gradle/'>Gradle</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/30/android-duplicate-copy/" itemprop="url">Duplicate Files Copied in Apk</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p><code>duplicate files copied in apk</code>が出た時は怒られた対象のファイルをbuild.gradleで<code>exclude</code>すれば回避できる。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">android</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">packagingOptions</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">exclude</span> <span class="s1">&#39;META-INF/LICENSE.txt&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-30T11:09:00+09:00" data-updated="true" itemprop="datePublished">2014/04/30</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/accountpicker/'>AccountPicker</a>, <a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/google/'>Google</a>, <a class='category' href='/blog/categories/login/'>Login</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/30/android-accountpicker/" itemprop="url">AndroidでGoogleアカウントを選択</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h1>ログインボタン</h1>

<p>↓を実行。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">AccountPicker</span><span class="o">.</span><span class="na">newChooseAccountIntent</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&quot;com.google&quot;</span><span class="o">},</span>
</span><span class='line'>        <span class="kc">false</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'><span class="n">startActivityForResult</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="n">PICK_ACCOUNT_REQUEST</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<h1>処理が終わったら</h1>

<p>選択されたアカウントを選び、そのアカウント名でTokenを取得。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="k">case</span> <span class="nl">PICK_ACCOUNT_REQUEST:</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span><span class="n">resultCode</span> <span class="o">==</span> <span class="n">RESULT_OK</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">accountName</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="n">AccountManager</span><span class="o">.</span><span class="na">KEY_ACCOUNT_NAME</span><span class="o">);</span>
</span><span class='line'>        <span class="n">LOG</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;Selected Account {}&quot;</span><span class="o">,</span> <span class="n">accountName</span><span class="o">);</span>
</span><span class='line'>        <span class="n">selectedAccount</span> <span class="o">=</span>  <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>        <span class="k">for</span> <span class="o">(</span><span class="n">Account</span> <span class="nl">a:</span><span class="n">list</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">accountName</span><span class="o">))</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">selectedAccount</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
</span><span class='line'>                <span class="k">break</span><span class="o">;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">selectedAccountName</span> <span class="o">=</span> <span class="n">accountName</span><span class="o">;</span>
</span><span class='line'>        <span class="n">am</span><span class="o">.</span><span class="na">getAuthToken</span><span class="o">(</span>
</span><span class='line'>                <span class="n">selectedAccount</span><span class="o">,</span>       <span class="c1">// Account retrieved using getAccountsByType()</span>
</span><span class='line'>                <span class="s">&quot;lh2&quot;</span><span class="o">,</span>                 <span class="c1">// Auth scope</span>
</span><span class='line'>                <span class="kc">null</span><span class="o">,</span>                  <span class="c1">// Authenticator-specific options</span>
</span><span class='line'>                <span class="k">this</span><span class="o">,</span>                  <span class="c1">// Your activity</span>
</span><span class='line'>                <span class="k">new</span> <span class="nf">OnTokenAcquired</span><span class="o">(),</span> <span class="c1">// Callback called when a token is successfully acquired</span>
</span><span class='line'>                <span class="kc">null</span><span class="o">);</span>                 <span class="c1">// Callback called if an error occ</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">break</span><span class="o">;</span>
</span></code></pre></td></tr></table></div></figure>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-30T11:03:36+09:00" data-updated="true" itemprop="datePublished">2014/04/30</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/gdata/'>GData</a>, <a class='category' href='/blog/categories/google/'>Google</a>, <a class='category' href='/blog/categories/picasa/'>Picasa</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/30/android-gdata-api/" itemprop="url">AndroidでPicasaにアクセスするときに依存するライブラリ</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h1>libsに直接置いたもの</h1>

<ul>
<li>gdata-client-1.0.jar</li>
<li>gdata-core-1.0.jar</li>
<li>gdata-media-1.0.jar</li>
<li>gdata-photos-2.0.jar</li>
</ul>


<h1>build.gradle</h1>

<ul>
<li><code>compile 'com.android.support:appcompat-v7:+'</code></li>
<li><code>compile 'com.google.android.gms:play-services:+'</code></li>
<li><code>compile fileTree(dir: 'libs', include: ['*.jar'])</code></li>
<li><code>compile 'com.google.guava:guava:16.0.1'</code></li>
<li><code>compile 'javax.activation:activation:1.1'</code></li>
<li><code>compile 'javax.mail:mail:1.4'</code></li>
<li><code>compile 'com.google.code.findbugs:jsr305:1.3.9'</code></li>
</ul>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-23T14:25:57+09:00" data-updated="true" itemprop="datePublished">2014/04/23</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/permission/'>Permission</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/23/android-delete-photo/" itemprop="url">Android端末の写真をコードから削除</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h1>パーミッションが必要</h1>

<p>これ超ハマった</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;manifest&gt;</span>
</span><span class='line'>    <span class="nt">&lt;application&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/application&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">&lt;!-- これ！ --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/manifest&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h1>コード</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// ボタンクリックで写真選択へ</span>
</span><span class='line'>        <span class="n">Button</span> <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button_open</span><span class="o">);</span>
</span><span class='line'>        <span class="n">b</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>            <span class="nd">@Override</span>
</span><span class='line'>            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
</span><span class='line'>                <span class="n">intent</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="s">&quot;image/*&quot;</span><span class="o">);</span>
</span><span class='line'>                <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_PICK</span><span class="o">);</span>
</span><span class='line'>                <span class="n">startActivityForResult</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">});</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onActivityResult</span><span class="o">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="o">,</span> <span class="kt">int</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">requestCode</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">resultCode</span> <span class="o">==</span> <span class="n">RESULT_OK</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">getContentResolver</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getData</span><span class="o">(),</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
</span><span class='line'>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MainActivity&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-23T12:27:44+09:00" data-updated="true" itemprop="datePublished">2014/04/23</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/service/'>Service</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/23/android-alarm-service/" itemprop="url">Androidバックグラウンドでの定期処理</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Androidでバックグランド処理を実行する方法。ここが簡潔にまとまっていていい。</p>

<p><a href="http://android.keicode.com/basics/services-schedule-with-alarmmanager.php">AlarmService を利用したサービス実行のスケジューリング &ndash; Android 開発入門</a></p>

<h1>サービスを登録・解除する画面</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// MainActivity.java</span>
</span><span class='line'>
</span><span class='line'><span class="n">AlarmManager</span> <span class="n">mManager</span><span class="o">;</span>
</span><span class='line'><span class="kd">final</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&quot;AlarmService&quot;</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// サービスの登録・解除で共通の処理</span>
</span><span class='line'><span class="kd">private</span> <span class="n">PendingIntent</span> <span class="nf">pendingIntent</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">Context</span> <span class="n">context</span> <span class="o">=</span> <span class="n">getBaseContext</span><span class="o">();</span>
</span><span class='line'>    <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">AlarmService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>    <span class="n">PendingIntent</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">getService</span><span class="o">(</span>
</span><span class='line'>      <span class="n">context</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span>
</span><span class='line'>      <span class="n">intent</span><span class="o">,</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">FLAG_UPDATE_CURRENT</span>
</span><span class='line'>    <span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">pi</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// サービスを登録するときに呼び出せばOK</span>
</span><span class='line'><span class="kd">private</span> <span class="kt">void</span> <span class="nf">scheduleService</span><span class="o">(){</span>
</span><span class='line'>    <span class="n">mManager</span><span class="o">.</span><span class="na">setInexactRepeating</span><span class="o">(</span>
</span><span class='line'>            <span class="n">AlarmManager</span><span class="o">.</span><span class="na">RTC</span><span class="o">,</span>
</span><span class='line'>            <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">(),</span>
</span><span class='line'>            <span class="n">AlarmManager</span><span class="o">.</span><span class="na">INTERVAL_HOUR</span><span class="o">,</span> <span class="c1">// 1時間毎に呼び出す</span>
</span><span class='line'>            <span class="n">pendingIntent</span><span class="o">()</span>
</span><span class='line'>    <span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// サービスを解除したいときに呼び出す</span>
</span><span class='line'><span class="kd">private</span> <span class="kt">void</span> <span class="nf">cancelService</span><span class="o">(){</span>
</span><span class='line'>    <span class="n">mManager</span><span class="o">.</span><span class="na">cancel</span><span class="o">(</span><span class="n">pendingIntent</span><span class="o">());</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h1>サービス本体</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// AlarmService.java</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AlarmService</span> <span class="kd">extends</span> <span class="n">IntentService</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">final</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&quot;AlarmService&quot;</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">AlarmService</span><span class="o">(){</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">(</span><span class="n">TAG</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHandleIntent</span><span class="o">(</span><span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&quot;onHandleIntent&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h1>AndroidManifest.xml</h1>

<p>AndroidManifest.xmlにサービスについて記載が必要なので、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;application&gt;</span>
</span><span class='line'>    <span class="nt">&lt;activity&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/activity&gt;</span>
</span><span class='line'>    <span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">&quot;.AlarmService&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- この行！ --&gt;</span>
</span><span class='line'><span class="nt">&lt;/application&gt;</span>
</span></code></pre></td></tr></table></div></figure>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-22T16:41:08+09:00" data-updated="true" itemprop="datePublished">2014/04/22</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/intent/'>Intent</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/notification/'>Notification</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/22/android-pending-intent/" itemprop="url">Androidで通知からアプリを起動する方法</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>  通知オブジェクトを作る際に<code>PendingIntent</code>を絡めておけば良い。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">MainActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'><span class="n">PendingIntent</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">getActivity</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">intent</span><span class="o">,</span> <span class="n">Intent</span><span class="o">.</span><span class="na">FLAG_ACTIVITY_NEW_TASK</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// notification</span>
</span><span class='line'><span class="n">NotificationManager</span> <span class="n">nm</span> <span class="o">=</span> <span class="o">(</span><span class="n">NotificationManager</span><span class="o">)</span><span class="n">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">Notification</span> <span class="n">n</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Notification</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setContentTitle</span><span class="o">(</span><span class="s">&quot;I&#39;m xoyip&quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setContentText</span><span class="o">(</span><span class="s">&quot;Notification From XOYIP!&quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setSmallIcon</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">ic_launcher</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setContentIntent</span><span class="o">(</span><span class="n">pi</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'><span class="n">nm</span><span class="o">.</span><span class="na">notify</span><span class="o">(</span><span class="n">uniq_number</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>ただしこれだけだと通知から起動するときに既存のアクティビティがあったとしても、新たなアクティビティが生成される仕組みになっているので<code>AndroidManifest.xml</code>でアクティビティの設定を変えてあげる必要がある。</p>

<p><code>android:launchMode</code>を<code>singleTop</code>などにすれば既存のアクティビティが再利用されるっぽい。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;activity</span>
</span><span class='line'>    <span class="na">android:name=</span><span class="s">&quot;com.xoyip.app.MainActivity&quot;</span>
</span><span class='line'>    <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
</span><span class='line'>    <span class="na">android:launchMode=</span><span class="s">&quot;singleTop&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;intent-filter&gt;</span>
</span><span class='line'>        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/intent-filter&gt;</span>
</span><span class='line'><span class="nt">&lt;/activity&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h1>参考</h1>

<table>
<thead>
<tr>
<th></th>
<th> Constant       </th>
<th> Value </th>
<th> Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td> standard       </td>
<td> 0     </td>
<td> The default mode, which will usually create a new instance of the activity when it is started, though this behavior may change with the introduction of other options such as Intent.FLAG_ACTIVITY_NEW_TASK.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |</td>
</tr>
<tr>
<td></td>
<td> singleTop      </td>
<td> 1     </td>
<td> If, when starting the activity, there is already an instance of the same activity class in the foreground that is interacting with the user, then re-use that instance. This existing instance will receive a call to Activity.onNewIntent() with the new Intent that is being started.                                                                                                                                                                                                                                                                                                                                                                                       |</td>
</tr>
<tr>
<td></td>
<td> singleTask     </td>
<td> 2     </td>
<td> If, when starting the activity, there is already a task running that starts with this activity, then instead of starting a new instance the current task is brought to the front. The existing instance will receive a call to Activity.onNewIntent() with the new Intent that is being started, and with the Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT flag set. This is a superset of the singleTop mode, where if there is already an instance of the activity being started at the top of the stack, it will receive the Intent as described there (without the FLAG_ACTIVITY_BROUGHT_TO_FRONT flag set). See the Tasks and Back Stack document for more details about tasks. |</td>
</tr>
<tr>
<td></td>
<td> singleInstance </td>
<td> 3     </td>
<td> Only allow one instance of this activity to ever be running. This activity gets a unique task with only itself running in it; if it is ever launched again with the same Intent, then that task will be brought forward and its Activity.onNewIntent() method called. If this activity tries to start a new activity, that new activity will be launched in a separate task. See the Tasks and Back Stack document for more details about tasks.                                                                                                                                                                                                                              |</td>
</tr>
</tbody>
</table>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-22T15:03:03+09:00" data-updated="true" itemprop="datePublished">2014/04/22</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/notification/'>Notification</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/22/android-notification/" itemprop="url">Androidでローカル通知</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// defined somewhere</span>
</span><span class='line'><span class="kd">private</span> <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// notification</span>
</span><span class='line'><span class="n">NotificationManager</span> <span class="n">nm</span> <span class="o">=</span> <span class="o">(</span><span class="n">NotificationManager</span><span class="o">)</span><span class="n">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">NOTIFICATION_SERVICE</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">Notification</span> <span class="n">n</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Notification</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setContentTitle</span><span class="o">(</span><span class="s">&quot;I&#39;m xoyip&quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setContentText</span><span class="o">(</span><span class="s">&quot;Notification From XOYIP!&quot;</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">setSmallIcon</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">ic_launcher</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'><span class="n">nm</span><span class="o">.</span><span class="na">notify</span><span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
</span><span class='line'><span class="o">++</span><span class="n">number</span><span class="o">;</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-22T14:55:43+09:00" data-updated="true" itemprop="datePublished">2014/04/22</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/async/'>Async</a>, <a class='category' href='/blog/categories/java/'>Java</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/22/android-post-delay/" itemprop="url">Androidで遅延実行。iOSのPerformSelectorみたいなやつ</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">import</span> <span class="nn">android.os.Handler</span><span class="o">;</span> <span class="c1">// import java.util.logging.Handler;ではない！！</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">Button</span> <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button_action</span><span class="o">);</span>
</span><span class='line'>        <span class="n">b</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>            <span class="nd">@Override</span>
</span><span class='line'>            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>                <span class="n">Runnable</span> <span class="n">task</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>                    <span class="nd">@Override</span>
</span><span class='line'>                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>                        <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MainActivity&quot;</span><span class="o">,</span> <span class="s">&quot;Run!&quot;</span><span class="o">);</span>
</span><span class='line'>                    <span class="o">}</span>
</span><span class='line'>                <span class="o">};</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// Runnable, Millisecond</span>
</span><span class='line'>                <span class="k">new</span> <span class="nf">Handler</span><span class="o">().</span><span class="na">postDelayed</span><span class="o">(</span><span class="n">task</span><span class="o">,</span> <span class="mi">1000</span><span class="o">);</span>
</span><span class='line'>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MainActivity&quot;</span><span class="o">,</span> <span class="s">&quot;Button Clicked&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">});</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-04-22T12:46:23+09:00" data-updated="true" itemprop="datePublished">2014/04/22</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/java/'>Java</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/04/22/android-resource/" itemprop="url">Androidのリソースに関するメモ</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Androidのリソースを追加するときは<code>src/main/res</code>以下にディレクトリを掘って行う。</p>

<ul>
<li><code>res/main/drawable</code>  画像全般</li>
<li><code>res/main/values</code>    デフォルトのValue、文字列など</li>
<li><code>res/main/values-ja</code> 日本語ロケールでのValue</li>
</ul>


		
		
	</div>

</article>

</div>
<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Posts</a></div>
</nav></div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2014

    xoyip


Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
		</div>
	</div>
	










</body>
</html>
